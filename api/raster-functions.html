<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Raster functions &mdash; Mosaic</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Usage" href="../usage/usage.html" />
    <link rel="prev" title="Spatial aggregation functions" href="spatial-aggregations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Mosaic
            <img src="../_static/mosaic_logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vector-format-readers.html">Vector Format Readers</a></li>
<li class="toctree-l2"><a class="reference internal" href="raster-format-readers.html">Raster Format Readers</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry-constructors.html">Geometry constructors</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry-accessors.html">Geometry accessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-functions.html">Spatial functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-indexing.html">Spatial grid indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-predicates.html">Spatial predicates</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial-aggregations.html">Spatial aggregation functions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Raster functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../literature/videos.html">Mosaic Videos and Talks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Mosaic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="api.html">API Documentation</a></li>
      <li class="breadcrumb-item active">Raster functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/raster-functions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="raster-functions">
<h1>Raster functions<a class="headerlink" href="#raster-functions" title="Permalink to this headline"></a></h1>
<div class="section" id="intro">
<h2>Intro<a class="headerlink" href="#intro" title="Permalink to this headline"></a></h2>
<p>Raster functions are available in mosaic if you have installed the optional dependency <cite>GDAL</cite>.
Please see <a class="reference internal" href="../usage/install-gdal.html"><span class="doc">Install and Enable GDAL with Mosaic</span></a> for installation instructions.
Mosaic provides several unique raster functions that are not available in other Spark packages.
Mainly raster to grid functions, which are useful for reprojecting the raster data into a standard grid index system.
This is useful for performing spatial joins between raster data and vector data.
Mosaic also provides a scalable retiling function that can be used to retile raster data in case of bottlenecking due to large files.
All raster functions respect the &quot;rst_&quot; prefix naming convention.</p>
<div class="section" id="rst-bandmetadata">
<h3>rst_bandmetadata<a class="headerlink" href="#rst-bandmetadata" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_bandmetadata">
<span class="sig-name descname"><span class="pre">rst_bandmetadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_bandmetadata" title="Permalink to this definition"></a></dt>
<dd><p>Extract the metadata describing the raster band.
Metadata is return as a map of key value pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>band</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The band number to extract metadata for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-0-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_bandmetadata</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">rst_bandmetadata</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>                                                           <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;_FillValue&quot;</span><span class="p">:</span> <span class="s2">&quot;251&quot;</span><span class="p">,</span> <span class="s2">&quot;NETCDF_DIM_time&quot;</span><span class="p">:</span> <span class="s2">&quot;1294315200&quot;</span><span class="p">,</span> <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;bleaching alert|</span>
<span class="o">|</span><span class="n">area</span> <span class="mi">7</span><span class="o">-</span><span class="n">day</span> <span class="n">maximum</span> <span class="n">composite</span><span class="s2">&quot;, &quot;</span><span class="n">grid_mapping</span><span class="s2">&quot;: &quot;</span><span class="n">crs</span><span class="s2">&quot;, &quot;</span><span class="n">NETCDF_VARNAME</span><span class="s2">&quot;:             |</span>
<span class="o">|</span><span class="s2">&quot;bleaching_alert_area&quot;</span><span class="p">,</span> <span class="s2">&quot;coverage_content_type&quot;</span><span class="p">:</span> <span class="s2">&quot;thematicClassification&quot;</span><span class="p">,</span>          <span class="o">|</span>
<span class="o">|</span><span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;N/A&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Bleaching Alert Area (BAA) values are coral     |</span>
<span class="o">|</span><span class="n">bleaching</span> <span class="n">heat</span> <span class="n">stress</span> <span class="n">levels</span><span class="p">:</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">No</span> <span class="n">Stress</span><span class="p">;</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">Bleaching</span> <span class="n">Watch</span><span class="p">;</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">Bleaching</span>     <span class="o">|</span>
<span class="o">|</span><span class="ne">Warning</span><span class="p">;</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">Bleaching</span> <span class="n">Alert</span> <span class="n">Level</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">Bleaching</span> <span class="n">Alert</span> <span class="n">Level</span> <span class="mf">2.</span> <span class="n">Product</span>          <span class="o">|</span>
<span class="o">|</span><span class="n">description</span> <span class="ow">is</span> <span class="n">provided</span> <span class="n">at</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">coralreefwatch</span><span class="o">.</span><span class="n">noaa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">product</span><span class="o">/</span><span class="mi">5</span><span class="n">km</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="o">.</span><span class="s2">&quot;, |</span>
<span class="o">|</span><span class="s2">&quot;valid_min&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;stress_level&quot;</span><span class="p">,</span> <span class="s2">&quot;valid_max&quot;</span><span class="p">:</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;scale_factor&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>   <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_bandmetadata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">)).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">rst_bandmetadata</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">                                                           </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;_FillValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;251&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NETCDF_DIM_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1294315200&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;long_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bleaching alert|</span>
<span class="s">|area 7-day maximum composite&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;grid_mapping&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;crs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NETCDF_VARNAME&quot;</span><span class="p">:</span><span class="w">             </span><span class="o">|</span>
<span class="o">|</span><span class="s">&quot;bleaching_alert_area&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;coverage_content_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;thematicClassification&quot;</span><span class="p">,</span><span class="w">          </span><span class="o">|</span>
<span class="o">|</span><span class="s">&quot;standard_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;N/A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;comment&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bleaching Alert Area (BAA) values are coral     |</span>
<span class="s">|bleaching heat stress levels: 0 - No Stress; 1 - Bleaching Watch; 2 - Bleaching     |</span>
<span class="s">|Warning; 3 - Bleaching Alert Level 1; 4 - Bleaching Alert Level 2. Product          |</span>
<span class="s">|description is provided at https://coralreefwatch.noaa.gov/product/5km/index.php.&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="s">&quot;valid_min&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stress_level&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;valid_max&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scale_factor&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">}</span><span class="w">   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_bandmetadata(path, 1) FROM coral_netcdf LIMIT 1
+------------------------------------------------------------------------------------+
|rst_bandmetadata(path, 1)                                                           |
+------------------------------------------------------------------------------------+
|{&quot;_FillValue&quot;: &quot;251&quot;, &quot;NETCDF_DIM_time&quot;: &quot;1294315200&quot;, &quot;long_name&quot;: &quot;bleaching alert|
|area 7-day maximum composite&quot;, &quot;grid_mapping&quot;: &quot;crs&quot;, &quot;NETCDF_VARNAME&quot;:             |
|&quot;bleaching_alert_area&quot;, &quot;coverage_content_type&quot;: &quot;thematicClassification&quot;,          |
|&quot;standard_name&quot;: &quot;N/A&quot;, &quot;comment&quot;: &quot;Bleaching Alert Area (BAA) values are coral     |
|bleaching heat stress levels: 0 - No Stress; 1 - Bleaching Watch; 2 - Bleaching     |
|Warning; 3 - Bleaching Alert Level 1; 4 - Bleaching Alert Level 2. Product          |
|description is provided at https://coralreefwatch.noaa.gov/product/5km/index.php.&quot;, |
|&quot;valid_min&quot;: &quot;0&quot;, &quot;units&quot;: &quot;stress_level&quot;, &quot;valid_max&quot;: &quot;4&quot;, &quot;scale_factor&quot;: &quot;1&quot;}   |
+------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-georeference">
<h3>rst_georeference<a class="headerlink" href="#rst-georeference" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_georeference">
<span class="sig-name descname"><span class="pre">rst_georeference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_georeference" title="Permalink to this definition"></a></dt>
<dd><p>Returns GeoTransform of the raster as a GT array of doubles.
GT(0) x-coordinate of the upper-left corner of the upper-left pixel.
GT(1) w-e pixel resolution / pixel width.
GT(2) row rotation (typically zero).
GT(3) y-coordinate of the upper-left corner of the upper-left pixel.
GT(4) column rotation (typically zero).
GT(5) n-s pixel resolution / pixel height (negative value for a north-up image).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: MapType(StringType, DoubleType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-1-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_georeference</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="o">+-------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">rst_georeference</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                     <span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;scaleY&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.049999999152053956</span><span class="p">,</span> <span class="s2">&quot;skewX&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;skewY&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;upperLeftY&quot;</span><span class="p">:</span> <span class="mf">89.99999847369712</span><span class="p">,</span> <span class="o">|</span>
<span class="o">|</span><span class="s2">&quot;upperLeftX&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">180.00000610436345</span><span class="p">,</span> <span class="s2">&quot;scaleX&quot;</span><span class="p">:</span> <span class="mf">0.050000001695656514</span><span class="p">}</span>                         <span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_georeference</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">rst_georeference</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                     </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;scaleY&quot;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mf">0.049999999152053956</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;skewX&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;skewY&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;upperLeftY&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">89.99999847369712</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="s">&quot;upperLeftX&quot;</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mf">180.00000610436345</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scaleX&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.050000001695656514</span><span class="p">}</span><span class="w">                         </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_georeference(path) FROM coral_netcdf LIMIT 1
+-------------------------------------------------------------------------------------------+
|rst_georeference(path)                                                                     |
+-------------------------------------------------------------------------------------------+
|{&quot;scaleY&quot;: -0.049999999152053956, &quot;skewX&quot;: 0, &quot;skewY&quot;: 0, &quot;upperLeftY&quot;: 89.99999847369712, |
|&quot;upperLeftX&quot;: -180.00000610436345, &quot;scaleX&quot;: 0.050000001695656514}                         |
+-------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-height">
<h3>rst_height<a class="headerlink" href="#rst-height" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_height">
<span class="sig-name descname"><span class="pre">rst_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_height" title="Permalink to this definition"></a></dt>
<dd><p>Returns the height of the raster in pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-2-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-2-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-2-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_height</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="mi">3600</span>                <span class="o">|</span>
<span class="o">|</span><span class="mi">3600</span>                <span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_height</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-isempty">
<h3>rst_isempty<a class="headerlink" href="#rst-isempty" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_isempty">
<span class="sig-name descname"><span class="pre">rst_isempty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_isempty" title="Permalink to this definition"></a></dt>
<dd><p>Returns true if the raster is empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: BooleanType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-3-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-3-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-3-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_isempty</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="n">false</span>               <span class="o">|</span>
<span class="o">|</span><span class="n">false</span>               <span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_isempty</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="kc">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="kc">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_isempty</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="k">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="k">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-memsize">
<h3>rst_memsize<a class="headerlink" href="#rst-memsize" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_memsize">
<span class="sig-name descname"><span class="pre">rst_memsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_memsize" title="Permalink to this definition"></a></dt>
<dd><p>Returns size of the raster in bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: LongType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-4-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-4-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-4-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-4-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-4-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_memsize</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>   <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="mi">730260</span>              <span class="o">|</span>
<span class="o">|</span><span class="mi">730260</span>              <span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_memsize</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_memsize</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-metadata">
<h3>rst_metadata<a class="headerlink" href="#rst-metadata" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_metadata">
<span class="sig-name descname"><span class="pre">rst_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_metadata" title="Permalink to this definition"></a></dt>
<dd><p>Extract the metadata describing the raster.
Metadata is return as a map of key value pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-5-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-5-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-5-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-5-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-5-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_metadata</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_metadata</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                               <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;NC_GLOBAL#publisher_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://coralreefwatch.noaa.gov&quot;</span><span class="p">,</span> <span class="s2">&quot;NC_GLOBAL#geospatial_lat_units&quot;</span><span class="p">:</span> <span class="s2">&quot;degrees_north&quot;</span><span class="p">,</span> <span class="o">|</span>
<span class="o">|</span><span class="s2">&quot;NC_GLOBAL#platform_vocabulary&quot;</span><span class="p">:</span> <span class="s2">&quot;NOAA NODC Ocean Archive System Platforms&quot;</span><span class="p">,</span> <span class="s2">&quot;NC_GLOBAL#creator_type&quot;</span><span class="p">:</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span>   <span class="o">|</span>
<span class="o">|</span><span class="s2">&quot;NC_GLOBAL#geospatial_lon_units&quot;</span><span class="p">:</span> <span class="s2">&quot;degrees_east&quot;</span><span class="p">,</span> <span class="s2">&quot;NC_GLOBAL#geospatial_bounds&quot;</span><span class="p">:</span> <span class="s2">&quot;POLYGON((-90.0 180.0, 90.0      |</span>
<span class="o">|</span><span class="mf">180.0</span><span class="p">,</span> <span class="mf">90.0</span> <span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.0</span> <span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.0</span> <span class="mf">180.0</span><span class="p">))</span><span class="s2">&quot;, &quot;</span><span class="n">NC_GLOBAL</span><span class="c1">#keywords&quot;: &quot;Oceans &gt; Ocean Temperature &gt; Sea Surface |</span>
<span class="o">|</span><span class="n">Temperature</span><span class="p">,</span> <span class="n">Oceans</span> <span class="o">&gt;</span> <span class="n">Ocean</span> <span class="n">Temperature</span> <span class="o">&gt;</span> <span class="n">Water</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">Spectral</span><span class="o">/</span><span class="n">Engineering</span> <span class="o">&gt;</span> <span class="n">Infrared</span> <span class="n">Wavelengths</span> <span class="o">&gt;</span> <span class="n">Thermal</span><span class="o">|</span>
<span class="o">|</span><span class="n">Infrared</span><span class="p">,</span> <span class="n">Oceans</span> <span class="o">&gt;</span> <span class="n">Ocean</span> <span class="n">Temperature</span> <span class="o">&gt;</span> <span class="n">Bleaching</span> <span class="n">Alert</span> <span class="n">Area</span><span class="s2">&quot;, &quot;</span><span class="n">NC_GLOBAL</span><span class="c1">#geospatial_lat_max&quot;: &quot;89.974998&quot;,        |</span>
<span class="o">|....</span> <span class="p">(</span><span class="n">truncated</span><span class="p">)</span><span class="o">....</span> <span class="s2">&quot;NC_GLOBAL#history&quot;</span><span class="p">:</span> <span class="s2">&quot;This is a product data file of the NOAA Coral Reef Watch Daily Global  |</span>
<span class="o">|</span><span class="mi">5</span><span class="n">km</span> <span class="n">Satellite</span> <span class="n">Coral</span> <span class="n">Bleaching</span> <span class="n">Heat</span> <span class="n">Stress</span> <span class="n">Monitoring</span> <span class="n">Product</span> <span class="n">Suite</span> <span class="n">Version</span> <span class="mf">3.1</span> <span class="p">(</span><span class="n">v3</span><span class="mf">.1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">its</span> <span class="n">NetCDF</span> <span class="n">Version</span> <span class="mf">1.0</span>   <span class="o">|</span>
<span class="o">|</span><span class="p">(</span><span class="n">v1</span><span class="mf">.0</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;, &quot;</span><span class="n">NC_GLOBAL</span><span class="c1">#publisher_institution&quot;: &quot;NOAA/NESDIS/STAR Coral Reef Watch Program&quot;,                         |</span>
<span class="o">|</span><span class="s2">&quot;NC_GLOBAL#cdm_data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Grid&quot;</span><span class="p">}</span>                                                                                <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                               </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;NC_GLOBAL#publisher_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://coralreefwatch.noaa.gov&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#geospatial_lat_units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;degrees_north&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="s">&quot;NC_GLOBAL#platform_vocabulary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NOAA NODC Ocean Archive System Platforms&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#creator_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="p">,</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="s">&quot;NC_GLOBAL#geospatial_lon_units&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;degrees_east&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#geospatial_bounds&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;POLYGON((-90.0 180.0, 90.0      |</span>
<span class="s">|180.0, 90.0 -180.0, -90.0 -180.0, -90.0 180.0))&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#keywords&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Oceans &gt; Ocean Temperature &gt; Sea Surface |</span>
<span class="s">|Temperature, Oceans &gt; Ocean Temperature &gt; Water Temperature, Spectral/Engineering &gt; Infrared Wavelengths &gt; Thermal|</span>
<span class="s">|Infrared, Oceans &gt; Ocean Temperature &gt; Bleaching Alert Area&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#geospatial_lat_max&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;89.974998&quot;</span><span class="p">,</span><span class="w">        </span><span class="o">|</span>
<span class="o">|</span><span class="p">....</span><span class="w"> </span><span class="p">(</span><span class="n">truncated</span><span class="p">)....</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#history&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;This is a product data file of the NOAA Coral Reef Watch Daily Global  |</span>
<span class="s">|5km Satellite Coral Bleaching Heat Stress Monitoring Product Suite Version 3.1 (v3.1) in its NetCDF Version 1.0   |</span>
<span class="s">|(v1.0).&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NC_GLOBAL#publisher_institution&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NOAA/NESDIS/STAR Coral Reef Watch Program&quot;</span><span class="p">,</span><span class="w">                         </span><span class="o">|</span>
<span class="o">|</span><span class="s">&quot;NC_GLOBAL#cdm_data_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Grid&quot;</span><span class="p">}</span><span class="w">                                                                                </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_metadata(path) FROM coral_netcdf LIMIT 1
+------------------------------------------------------------------------------------------------------------------+
| rst_metadata(path)                                                                                               |
+------------------------------------------------------------------------------------------------------------------+
|{&quot;NC_GLOBAL#publisher_url&quot;: &quot;https://coralreefwatch.noaa.gov&quot;, &quot;NC_GLOBAL#geospatial_lat_units&quot;: &quot;degrees_north&quot;, |
|&quot;NC_GLOBAL#platform_vocabulary&quot;: &quot;NOAA NODC Ocean Archive System Platforms&quot;, &quot;NC_GLOBAL#creator_type&quot;: &quot;group&quot;,   |
|&quot;NC_GLOBAL#geospatial_lon_units&quot;: &quot;degrees_east&quot;, &quot;NC_GLOBAL#geospatial_bounds&quot;: &quot;POLYGON((-90.0 180.0, 90.0      |
|180.0, 90.0 -180.0, -90.0 -180.0, -90.0 180.0))&quot;, &quot;NC_GLOBAL#keywords&quot;: &quot;Oceans &gt; Ocean Temperature &gt; Sea Surface |
|Temperature, Oceans &gt; Ocean Temperature &gt; Water Temperature, Spectral/Engineering &gt; Infrared Wavelengths &gt; Thermal|
|Infrared, Oceans &gt; Ocean Temperature &gt; Bleaching Alert Area&quot;, &quot;NC_GLOBAL#geospatial_lat_max&quot;: &quot;89.974998&quot;,        |
|.... (truncated).... &quot;NC_GLOBAL#history&quot;: &quot;This is a product data file of the NOAA Coral Reef Watch Daily Global  |
|5km Satellite Coral Bleaching Heat Stress Monitoring Product Suite Version 3.1 (v3.1) in its NetCDF Version 1.0   |
|(v1.0).&quot;, &quot;NC_GLOBAL#publisher_institution&quot;: &quot;NOAA/NESDIS/STAR Coral Reef Watch Program&quot;,                         |
|&quot;NC_GLOBAL#cdm_data_type&quot;: &quot;Grid&quot;}                                                                                |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-numbands">
<h3>rst_numbands<a class="headerlink" href="#rst-numbands" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_numbands">
<span class="sig-name descname"><span class="pre">rst_numbands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_numbands" title="Permalink to this definition"></a></dt>
<dd><p>Returns number of bands in the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-6-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-6-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-6-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-6-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-6-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_numbands</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="n">rst_numbands</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>  <span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="mi">1</span>                   <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span>                   <span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_numbands</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">  </span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_numbands</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-pixelheight">
<h3>rst_pixelheight<a class="headerlink" href="#rst-pixelheight" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_pixelheight">
<span class="sig-name descname"><span class="pre">rst_pixelheight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_pixelheight" title="Permalink to this definition"></a></dt>
<dd><p>Returns the height of the pixel in the raster derived via GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-7-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-7-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-7-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-7-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-7-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="mi">1</span>                   <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span>                   <span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-pixelwidth">
<h3>rst_pixelwidth<a class="headerlink" href="#rst-pixelwidth" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_pixelwidth">
<span class="sig-name descname"><span class="pre">rst_pixelwidth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_pixelwidth" title="Permalink to this definition"></a></dt>
<dd><p>Returns the width of the pixel in the raster derived via GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-8-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-8-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-8-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-8-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-8-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="mi">1</span>                   <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span>                   <span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-rastertogridavg">
<h3>rst_rastertogridavg<a class="headerlink" href="#rst-rastertogridavg" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridavg">
<span class="sig-name descname"><span class="pre">rst_rastertogridavg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridavg" title="Permalink to this definition"></a></dt>
<dd><p>The result is a 2D array of cells, where each cell is a struct of (cellID, value).
For getting the output of cellID-&gt;value pairs, please use explode() function twice.
CellID can be LongType or StringType depending on the configuration of MosaicContext.
The value/measure for each cell is the average of the pixel values in the cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>raster</strong> – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-9-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-9-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-9-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-9-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-9-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                                     <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593176490141548543&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593386771740360703&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593308294097928191&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593825202001936383&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593163914477305855&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592998781574709247&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.1283185840707965</span><span class="p">},</span>  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593262526926422015&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592370479398911999&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593472602366803967&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.3963963963963964</span><span class="p">},</span>                                                  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593785619583336447&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.6590909090909091</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;591988330388783103&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592336738135834623&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">....</span><span class="p">]]</span>                                                            <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593176490141548543&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593386771740360703&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593308294097928191&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593825202001936383&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593163914477305855&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592998781574709247&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593262526926422015&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592370479398911999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593472602366803967&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593785619583336447&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;591988330388783103&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592336738135834623&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_rastertogridavg(path, 3)
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridavg(path, 3)                                                                                     |
+------------------------------------------------------------------------------------------------------------------+
|[[{&quot;cellID&quot;: &quot;593176490141548543&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593386771740360703&quot;, &quot;measure&quot;: 1.2037735849056603},|
|{&quot;cellID&quot;: &quot;593308294097928191&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593825202001936383&quot;, &quot;measure&quot;: 0},                   |
|{&quot;cellID&quot;: &quot;593163914477305855&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592998781574709247&quot;, &quot;measure&quot;: 1.1283185840707965},  |
|{&quot;cellID&quot;: &quot;593262526926422015&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592370479398911999&quot;, &quot;measure&quot;: 0},                   |
|{&quot;cellID&quot;: &quot;593472602366803967&quot;, &quot;measure&quot;: 0.3963963963963964},                                                  |
|{&quot;cellID&quot;: &quot;593785619583336447&quot;, &quot;measure&quot;: 0.6590909090909091}, {&quot;cellID&quot;: &quot;591988330388783103&quot;, &quot;measure&quot;: 1},  |
|{&quot;cellID&quot;: &quot;592336738135834623&quot;, &quot;measure&quot;: 1}, ....]]                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<div class="doc-figure figure align-default" id="id2">
<img alt="../_images/h3.png" src="../_images/h3.png" />
<p class="caption"><span class="caption-text">Fig 1. RST_RasterToGridAvg(raster, 3)</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</div>
</div>
<div class="section" id="rst-rastertogridcount">
<h3>rst_rastertogridcount<a class="headerlink" href="#rst-rastertogridcount" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridcount">
<span class="sig-name descname"><span class="pre">rst_rastertogridcount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridcount" title="Permalink to this definition"></a></dt>
<dd><p>The result is a 2D array of cells, where each cell is a struct of (cellID, value).
For getting the output of cellID-&gt;value pairs, please use explode() function twice.
CellID can be LongType or StringType depending on the configuration of MosaicContext.
The value/measure for each cell is the average of the pixel values in the cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>raster</strong> – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-10-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-10-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-10-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-10-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-10-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                                   <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593176490141548543&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593386771740360703&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>                 <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593308294097928191&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593825202001936383&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593163914477305855&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592998781574709247&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593262526926422015&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592370479398911999&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593472602366803967&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>                                                                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593785619583336447&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;591988330388783103&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592336738135834623&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">....</span><span class="p">]]</span>                                                            <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593176490141548543&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593386771740360703&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">                 </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593308294097928191&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593825202001936383&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593163914477305855&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592998781574709247&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593262526926422015&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592370479398911999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593472602366803967&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w">                                                                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593785619583336447&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;591988330388783103&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592336738135834623&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_rastertogridcount(path, 3)
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridcount(path, 3)                                                                                   |
+------------------------------------------------------------------------------------------------------------------+
|[[{&quot;cellID&quot;: &quot;593176490141548543&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593386771740360703&quot;, &quot;measure&quot;: 1},                 |
|{&quot;cellID&quot;: &quot;593308294097928191&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593825202001936383&quot;, &quot;measure&quot;: 0},                   |
|{&quot;cellID&quot;: &quot;593163914477305855&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592998781574709247&quot;, &quot;measure&quot;: 1},                   |
|{&quot;cellID&quot;: &quot;593262526926422015&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592370479398911999&quot;, &quot;measure&quot;: 0},                   |
|{&quot;cellID&quot;: &quot;593472602366803967&quot;, &quot;measure&quot;: 3},                                                                   |
|{&quot;cellID&quot;: &quot;593785619583336447&quot;, &quot;measure&quot;: 3}, {&quot;cellID&quot;: &quot;591988330388783103&quot;, &quot;measure&quot;: 1},                   |
|{&quot;cellID&quot;: &quot;592336738135834623&quot;, &quot;measure&quot;: 1}, ....]]                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<div class="doc-figure figure align-default" id="id3">
<img alt="../_images/h3.png" src="../_images/h3.png" />
<p class="caption"><span class="caption-text">Fig 2. RST_RasterToGridCount(raster, 3)</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</div>
</div>
<div class="section" id="rst-rastertogridmax">
<h3>rst_rastertogridmax<a class="headerlink" href="#rst-rastertogridmax" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridmax">
<span class="sig-name descname"><span class="pre">rst_rastertogridmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridmax" title="Permalink to this definition"></a></dt>
<dd><p>The result is a 2D array of cells, where each cell is a struct of (cellID, value).
For getting the output of cellID-&gt;value pairs, please use explode() function twice.
CellID can be LongType or StringType depending on the configuration of MosaicContext.
The value/measure for each cell is the maximum pixel value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>raster</strong> – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-11-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-11-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-11-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-11-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-11-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                                     <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593176490141548543&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593386771740360703&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593308294097928191&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593825202001936383&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593163914477305855&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592998781574709247&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.1283185840707965</span><span class="p">},</span>  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593262526926422015&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592370479398911999&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593472602366803967&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.3963963963963964</span><span class="p">},</span>                                                  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593785619583336447&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.6590909090909091</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;591988330388783103&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592336738135834623&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">....</span><span class="p">]]</span>                                                            <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593176490141548543&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593386771740360703&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593308294097928191&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593825202001936383&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593163914477305855&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592998781574709247&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593262526926422015&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592370479398911999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593472602366803967&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593785619583336447&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;591988330388783103&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592336738135834623&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_rastertogridmax(path, 3)
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridmax(path, 3)                                                                                     |
+------------------------------------------------------------------------------------------------------------------+
|[[{&quot;cellID&quot;: &quot;593176490141548543&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593386771740360703&quot;, &quot;measure&quot;: 1.2037735849056603},|
|{&quot;cellID&quot;: &quot;593308294097928191&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593825202001936383&quot;, &quot;measure&quot;: 0},                   |
|{&quot;cellID&quot;: &quot;593163914477305855&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592998781574709247&quot;, &quot;measure&quot;: 1.1283185840707965},  |
|{&quot;cellID&quot;: &quot;593262526926422015&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592370479398911999&quot;, &quot;measure&quot;: 0},                   |
|{&quot;cellID&quot;: &quot;593472602366803967&quot;, &quot;measure&quot;: 0.3963963963963964},                                                  |
|{&quot;cellID&quot;: &quot;593785619583336447&quot;, &quot;measure&quot;: 0.6590909090909091}, {&quot;cellID&quot;: &quot;591988330388783103&quot;, &quot;measure&quot;: 1},  |
|{&quot;cellID&quot;: &quot;592336738135834623&quot;, &quot;measure&quot;: 1}, ....]]                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<div class="doc-figure figure align-default" id="id4">
<img alt="../_images/h3.png" src="../_images/h3.png" />
<p class="caption"><span class="caption-text">Fig 3. RST_RasterToGridMax(raster, 3)</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</div>
</div>
<div class="section" id="rst-rastertogridmedian">
<h3>rst_rastertogridmedian<a class="headerlink" href="#rst-rastertogridmedian" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridmedian">
<span class="sig-name descname"><span class="pre">rst_rastertogridmedian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridmedian" title="Permalink to this definition"></a></dt>
<dd><p>The result is a 2D array of cells, where each cell is a struct of (cellID, value).
For getting the output of cellID-&gt;value pairs, please use explode() function twice.
CellID can be LongType or StringType depending on the configuration of MosaicContext.
The value/measure for each cell is the median pixel value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>raster</strong> – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-12-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-12-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-12-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-12-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-12-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                                  <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593176490141548543&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593386771740360703&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593308294097928191&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593825202001936383&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593163914477305855&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592998781574709247&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.1283185840707965</span><span class="p">},</span>  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593262526926422015&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592370479398911999&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593472602366803967&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.3963963963963964</span><span class="p">},</span>                                                  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593785619583336447&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.6590909090909091</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;591988330388783103&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592336738135834623&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">....</span><span class="p">]]</span>                                                            <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-12-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593176490141548543&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593386771740360703&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593308294097928191&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593825202001936383&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593163914477305855&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592998781574709247&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593262526926422015&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592370479398911999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593472602366803967&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593785619583336447&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;591988330388783103&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592336738135834623&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-12-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_rastertogridmax(path, 3)
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridmedian(path, 3)                                                                                  |
+------------------------------------------------------------------------------------------------------------------+
|[[{&quot;cellID&quot;: &quot;593176490141548543&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593386771740360703&quot;, &quot;measure&quot;: 1.2037735849056603},|
|{&quot;cellID&quot;: &quot;593308294097928191&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593825202001936383&quot;, &quot;measure&quot;: 0},                   |
|{&quot;cellID&quot;: &quot;593163914477305855&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592998781574709247&quot;, &quot;measure&quot;: 1.1283185840707965},  |
|{&quot;cellID&quot;: &quot;593262526926422015&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592370479398911999&quot;, &quot;measure&quot;: 0},                   |
|{&quot;cellID&quot;: &quot;593472602366803967&quot;, &quot;measure&quot;: 0.3963963963963964},                                                  |
|{&quot;cellID&quot;: &quot;593785619583336447&quot;, &quot;measure&quot;: 0.6590909090909091}, {&quot;cellID&quot;: &quot;591988330388783103&quot;, &quot;measure&quot;: 1},  |
|{&quot;cellID&quot;: &quot;592336738135834623&quot;, &quot;measure&quot;: 1}, ....]]                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<div class="doc-figure figure align-default" id="id5">
<img alt="../_images/h3.png" src="../_images/h3.png" />
<p class="caption"><span class="caption-text">Fig 4. RST_RasterToGridMedian(raster, 3)</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</div>
</div>
<div class="section" id="rst-rastertogridmin">
<h3>rst_rastertogridmin<a class="headerlink" href="#rst-rastertogridmin" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridmin">
<span class="sig-name descname"><span class="pre">rst_rastertogridmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridmin" title="Permalink to this definition"></a></dt>
<dd><p>The result is a 2D array of cells, where each cell is a struct of (cellID, value).
For getting the output of cellID-&gt;value pairs, please use explode() function twice.
CellID can be LongType or StringType depending on the configuration of MosaicContext.
The value/measure for each cell is the median pixel value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>raster</strong> – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-13-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-13-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-13-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-13-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-13-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                                     <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593176490141548543&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593386771740360703&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593308294097928191&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593825202001936383&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593163914477305855&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592998781574709247&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">1.1283185840707965</span><span class="p">},</span>  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593262526926422015&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592370479398911999&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>                   <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593472602366803967&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.3963963963963964</span><span class="p">},</span>                                                  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;593785619583336447&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mf">0.6590909090909091</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;591988330388783103&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>  <span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s2">&quot;cellID&quot;</span><span class="p">:</span> <span class="s2">&quot;592336738135834623&quot;</span><span class="p">,</span> <span class="s2">&quot;measure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">....</span><span class="p">]]</span>                                                            <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-13-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593176490141548543&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593386771740360703&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593308294097928191&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593825202001936383&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593163914477305855&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592998781574709247&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593262526926422015&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592370479398911999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593472602366803967&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;593785619583336447&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;591988330388783103&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">&quot;cellID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;592336738135834623&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;measure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-13-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_rastertogridmin(path, 3)
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridmin(path, 3)                                                                                     |
+------------------------------------------------------------------------------------------------------------------+
|[[{&quot;cellID&quot;: &quot;593176490141548543&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593386771740360703&quot;, &quot;measure&quot;: 1.2037735849056603},|
|{&quot;cellID&quot;: &quot;593308294097928191&quot;, &quot;measure&quot;: 0}, {&quot;cellID&quot;: &quot;593825202001936383&quot;, &quot;measure&quot;: 0},                   |
|{&quot;cellID&quot;: &quot;593163914477305855&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592998781574709247&quot;, &quot;measure&quot;: 1.1283185840707965},  |
|{&quot;cellID&quot;: &quot;593262526926422015&quot;, &quot;measure&quot;: 2}, {&quot;cellID&quot;: &quot;592370479398911999&quot;, &quot;measure&quot;: 0},                   |
|{&quot;cellID&quot;: &quot;593472602366803967&quot;, &quot;measure&quot;: 0.3963963963963964},                                                  |
|{&quot;cellID&quot;: &quot;593785619583336447&quot;, &quot;measure&quot;: 0.6590909090909091}, {&quot;cellID&quot;: &quot;591988330388783103&quot;, &quot;measure&quot;: 1},  |
|{&quot;cellID&quot;: &quot;592336738135834623&quot;, &quot;measure&quot;: 1}, ....]]                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<div class="doc-figure figure align-default" id="id6">
<img alt="../_images/h3.png" src="../_images/h3.png" />
<p class="caption"><span class="caption-text">Fig 4. RST_RasterToGridMin(raster, 3)</span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</div>
</div>
<div class="section" id="rst-rastertoworldcoord">
<h3>rst_rastertoworldcoord<a class="headerlink" href="#rst-rastertoworldcoord" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertoworldcoord">
<span class="sig-name descname"><span class="pre">rst_rastertoworldcoord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertoworldcoord" title="Permalink to this definition"></a></dt>
<dd><p>Computes the world coordinates of the raster pixel at the given x and y coordinates.
The result is a WKT point geometry.
The coordinates are computed using the GeoTransform of the raster to respect the projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – x coordinate of the pixel.</p></li>
<li><p><strong>y</strong> – y coordinate of the pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-14-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-14-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-14-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-14-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-14-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                               <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POINT</span> <span class="p">(</span><span class="o">-</span><span class="mf">179.85000609927647</span> <span class="mf">89.84999847624096</span><span class="p">)</span>                                                                     <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-14-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                               </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mf">179.85000609927647</span><span class="w"> </span><span class="mf">89.84999847624096</span><span class="p">)</span><span class="w">                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-14-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">179</span><span class="p">.</span><span class="mi">85000609927647</span><span class="w"> </span><span class="mi">89</span><span class="p">.</span><span class="mi">84999847624096</span><span class="p">)</span><span class="w">                                                                     </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-rastertoworldcoordx">
<h3>rst_rastertoworldcoordx<a class="headerlink" href="#rst-rastertoworldcoordx" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">rst_rastertoworldcoord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd><p>Computes the world coordinates of the raster pixel at the given x and y coordinates.
The result is the X coordinate of the point after applying the GeoTransform of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – x coordinate of the pixel.</p></li>
<li><p><strong>y</strong> – y coordinate of the pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-15-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-15-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-15-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-15-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-15-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="o">-</span><span class="mf">179.85000609927647</span>                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-15-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">179.85000609927647</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-15-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mi">179</span><span class="p">.</span><span class="mi">85000609927647</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-rastertoworldcoordy">
<h3>rst_rastertoworldcoordy<a class="headerlink" href="#rst-rastertoworldcoordy" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertoworldcoordy">
<span class="sig-name descname"><span class="pre">rst_rastertoworldcoordy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertoworldcoordy" title="Permalink to this definition"></a></dt>
<dd><p>Computes the world coordinates of the raster pixel at the given x and y coordinates.
The result is the X coordinate of the point after applying the GeoTransform of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – x coordinate of the pixel.</p></li>
<li><p><strong>y</strong> – y coordinate of the pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-16-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-16-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-16-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-16-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-16-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">89.84999847624096</span>                                                                                                <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-16-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">89.84999847624096</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-16-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">89</span><span class="p">.</span><span class="mi">84999847624096</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-retile">
<h3>rst_retile<a class="headerlink" href="#rst-retile" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_retile">
<span class="sig-name descname"><span class="pre">rst_retile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_retile" title="Permalink to this definition"></a></dt>
<dd><p>Retiles the raster to the given tile size. The result is a collection of new raster files.
The new rasters are stored in the checkpoint directory.
The results are the paths to the new rasters.
The result set is automatically exploded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>width</strong> – The width of the tiles.</p></li>
<li><p><strong>height</strong> – The height of the tiles.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-17-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-17-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-17-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-17-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-17-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_retile</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_retile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>                                                                                       <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_1095576780709022500</span><span class="o">.</span><span class="n">tif</span>                                                <span class="o">|</span>
<span class="o">|</span> <span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_</span><span class="o">-</span><span class="mf">1042125519107460588.</span><span class="n">tif</span>                                               <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-17-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_retile</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_retile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">)</span><span class="w">                                                                                       </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_1095576780709022500</span><span class="p">.</span><span class="n">tif</span><span class="w">                                                </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_-</span><span class="mi">1042125519107460588</span><span class="p">.</span><span class="n">tif</span><span class="w">                                               </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-17-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_retile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_retile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">)</span><span class="w">                                                                                       </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="k">checkpoint</span><span class="o">/</span><span class="n">raster_1095576780709022500</span><span class="p">.</span><span class="n">tif</span><span class="w">                                                </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="k">checkpoint</span><span class="o">/</span><span class="n">raster_</span><span class="o">-</span><span class="mi">1042125519107460588</span><span class="p">.</span><span class="n">tif</span><span class="w">                                               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-rotation">
<h3>rst_rotation<a class="headerlink" href="#rst-rotation" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rotation">
<span class="sig-name descname"><span class="pre">rst_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rotation" title="Permalink to this definition"></a></dt>
<dd><p>Computes the rotation of the raster in degrees.
The rotation is the angle between the X axis and the North axis.
The rotation is computed using the GeoTransform of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-18-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-18-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-18-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-18-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-18-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rotation</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_rotation</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                               <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">1.2</span>                                                                                                              <span class="o">|</span>
<span class="o">|</span> <span class="mf">21.2</span>                                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-18-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                               </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mf">21.2</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-18-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">21</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-scalex">
<h3>rst_scalex<a class="headerlink" href="#rst-scalex" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_scalex">
<span class="sig-name descname"><span class="pre">rst_scalex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_scalex" title="Permalink to this definition"></a></dt>
<dd><p>Computes the scale of the raster in the X direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-19-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-19-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-19-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-19-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-19-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_scalex</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_scalex</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                                 <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">1.2</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-19-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-19-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-scaley">
<h3>rst_scaley<a class="headerlink" href="#rst-scaley" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_scaley">
<span class="sig-name descname"><span class="pre">rst_scaley</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_scaley" title="Permalink to this definition"></a></dt>
<dd><p>Computes the scale of the raster in the Y direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-20-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-20-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-20-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-20-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-20-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_scaley</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_scaley</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                                 <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">1.2</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-20-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-20-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-skewx">
<h3>rst_skewx<a class="headerlink" href="#rst-skewx" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_skewx">
<span class="sig-name descname"><span class="pre">rst_skewx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_skewx" title="Permalink to this definition"></a></dt>
<dd><p>Computes the skew of the raster in the X direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-21-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-21-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-21-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-21-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-21-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_skewx</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_skewx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                                  <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">1.2</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-21-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-21-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-skewy">
<h3>rst_skewy<a class="headerlink" href="#rst-skewy" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">rst_skewx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id1" title="Permalink to this definition"></a></dt>
<dd><p>Computes the skew of the raster in the Y direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-22-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-22-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-22-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-22-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-22-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_skewy</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_skewy</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                                  <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">1.2</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-22-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-22-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-srid">
<h3>rst_srid<a class="headerlink" href="#rst-srid" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_srid">
<span class="sig-name descname"><span class="pre">rst_srid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_srid" title="Permalink to this definition"></a></dt>
<dd><p>Computes the SRID of the raster.
The SRID is the EPSG code of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-23-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-23-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-23-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-23-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-23-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_srid</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_srid</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                                   <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mi">9122</span>                                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-23-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_srid</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_srid</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">9122</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-23-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_srid</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_srid</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">9122</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-subdatasets">
<h3>rst_subdatasets<a class="headerlink" href="#rst-subdatasets" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_subdatasets">
<span class="sig-name descname"><span class="pre">rst_subdatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_subdatasets" title="Permalink to this definition"></a></dt>
<dd><p>Computes the subdatasets of the raster.
The subdatasets are the paths to the subdatasets of the raster.
The result is a map of the subdataset path to the subdatasets and the description of the subdatasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-24-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-24-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-24-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-24-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-24-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_subdatasets</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_subdatasets</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                            <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;NETCDF:</span><span class="se">\&quot;</span><span class="s2">/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_2022010|</span>
<span class="o">|</span><span class="mi">6</span><span class="o">-</span><span class="mf">1.</span><span class="n">nc</span>\<span class="s2">&quot;:bleaching_alert_area&quot;</span><span class="p">:</span> <span class="s2">&quot;[1x3600x7200] N/A (8-bit unsigned integer)&quot;</span><span class="p">,</span> <span class="s2">&quot;NETCDF:</span><span class="se">\&quot;</span><span class="s2">/dbfs/FileStore/geospatial|</span>
<span class="o">|/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">sample_raster_data</span><span class="o">/</span><span class="n">binary</span><span class="o">/</span><span class="n">netcdf</span><span class="o">-</span><span class="n">coral</span><span class="o">/</span><span class="n">ct5km_baa_max_7d_v3_1_20220106</span><span class="o">-</span><span class="mf">1.</span><span class="n">nc</span>\<span class="s2">&quot;:mask&quot;</span><span class="p">:</span> <span class="s2">&quot;[1x3600x7200] mask (8|</span>
<span class="o">|-</span><span class="n">bit</span> <span class="n">unsigned</span> <span class="n">integer</span><span class="p">)</span><span class="s2">&quot;}                                                                                          |</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-24-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_subdatasets</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_subdatasets</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;NETCDF:\&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_2022010|</span>
<span class="s">|6-1.nc\&quot;:bleaching_alert_area&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;[1x3600x7200] N/A (8-bit unsigned integer)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NETCDF:\&quot;/dbfs/FileStore/geospatial|</span>
<span class="s">|/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc\&quot;:mask&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;[1x3600x7200] mask (8|</span>
<span class="s">|-bit unsigned integer)&quot;</span><span class="p">}</span><span class="w">                                                                                          </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-24-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_subdatasets(path)
+------------------------------------------------------------------------------------------------------------------+
| rst_subdatasets(path)                                                                                            |
+------------------------------------------------------------------------------------------------------------------+
| {&quot;NETCDF:\&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_2022010|
|6-1.nc\&quot;:bleaching_alert_area&quot;: &quot;[1x3600x7200] N/A (8-bit unsigned integer)&quot;, &quot;NETCDF:\&quot;/dbfs/FileStore/geospatial|
|/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc\&quot;:mask&quot;: &quot;[1x3600x7200] mask (8|
|-bit unsigned integer)&quot;}                                                                                          |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-summary">
<h3>rst_summary<a class="headerlink" href="#rst-summary" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_summary">
<span class="sig-name descname"><span class="pre">rst_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_summary" title="Permalink to this definition"></a></dt>
<dd><p>Computes the summary of the raster.
The summary is a map of the statistics of the raster.
The logic is produced by gdalinfo procedure.
The result is stored as JSON.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-25-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-25-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-25-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-25-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-25-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_summary</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_summary</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                                <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span>   <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1|</span>
<span class="o">|</span><span class="n">_20220106</span><span class="o">-</span><span class="mf">1.</span><span class="n">nc</span><span class="s2">&quot;,   &quot;</span><span class="n">driverShortName</span><span class="s2">&quot;:&quot;</span><span class="n">netCDF</span><span class="s2">&quot;,   &quot;</span><span class="n">driverLongName</span><span class="s2">&quot;:&quot;</span><span class="n">Network</span> <span class="n">Common</span> <span class="n">Data</span> <span class="n">Format</span><span class="s2">&quot;,   &quot;</span><span class="n">files</span><span class="s2">&quot;:[       |</span>
<span class="o">|</span><span class="s2">&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc&quot;</span>    <span class="o">|</span>
<span class="o">|</span><span class="p">],</span>   <span class="s2">&quot;size&quot;</span><span class="p">:[</span>     <span class="mi">512</span><span class="p">,</span>     <span class="mi">512</span>   <span class="p">],</span>   <span class="s2">&quot;metadata&quot;</span><span class="p">:{</span>     <span class="s2">&quot;&quot;</span><span class="p">:{</span>       <span class="s2">&quot;NC_GLOBAL#acknowledgement&quot;</span><span class="p">:</span><span class="s2">&quot;NOAA Coral Reef    |</span>
<span class="o">|</span><span class="n">Watch</span> <span class="n">Program</span><span class="s2">&quot;,       &quot;</span><span class="n">NC_GLOBAL</span><span class="c1">#cdm_data_type&quot;:&quot;Gr...                                                            |</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-25-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-25-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span>val df = spark.read
    .format(&quot;binaryFile&quot;).option(&quot;pathGlobFilter&quot;, &quot;*.nc&quot;)
    .load(&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
df.select(rst_summary(col(&quot;path&quot;)).show()
+------------------------------------------------------------------------------------------------------------------+
| rst_summary(path)                                                                                                |
+------------------------------------------------------------------------------------------------------------------+
| {   &quot;description&quot;:&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1|
|_20220106-1.nc&quot;,   &quot;driverShortName&quot;:&quot;netCDF&quot;,   &quot;driverLongName&quot;:&quot;Network Common Data Format&quot;,   &quot;files&quot;:[       |
|&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc&quot;    |
|],   &quot;size&quot;:[     512,     512   ],   &quot;metadata&quot;:{     &quot;&quot;:{       &quot;NC_GLOBAL#acknowledgement&quot;:&quot;NOAA Coral Reef    |
|Watch Program&quot;,       &quot;NC_GLOBAL#cdm_data_type&quot;:&quot;Gr...                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-25-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-25-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_summary(path)
+------------------------------------------------------------------------------------------------------------------+
| rst_summary(path)                                                                                                |
+------------------------------------------------------------------------------------------------------------------+
| {   &quot;description&quot;:&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1|
|_20220106-1.nc&quot;,   &quot;driverShortName&quot;:&quot;netCDF&quot;,   &quot;driverLongName&quot;:&quot;Network Common Data Format&quot;,   &quot;files&quot;:[       |
|&quot;/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc&quot;    |
|],   &quot;size&quot;:[     512,     512   ],   &quot;metadata&quot;:{     &quot;&quot;:{       &quot;NC_GLOBAL#acknowledgement&quot;:&quot;NOAA Coral Reef    |
|Watch Program&quot;,       &quot;NC_GLOBAL#cdm_data_type&quot;:&quot;Gr...                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-upperleftx">
<h3>rst_upperleftx<a class="headerlink" href="#rst-upperleftx" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_upperleftx">
<span class="sig-name descname"><span class="pre">rst_upperleftx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_upperleftx" title="Permalink to this definition"></a></dt>
<dd><p>Computes the upper left X coordinate of the raster.
The value is computed based on GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-26-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-26-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-26-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-26-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-26-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="o">-</span><span class="mf">180.00000610436345</span>                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-26-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">180.00000610436345</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-26-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mi">180</span><span class="p">.</span><span class="mi">00000610436345</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-upperlefty">
<h3>rst_upperlefty<a class="headerlink" href="#rst-upperlefty" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_upperlefty">
<span class="sig-name descname"><span class="pre">rst_upperlefty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_upperlefty" title="Permalink to this definition"></a></dt>
<dd><p>Computes the upper left Y coordinate of the raster.
The value is computed based on GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-27-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-27-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-27-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-27-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-27-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mf">89.99999847369712</span>                                                                                                <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-27-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">89.99999847369712</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-27-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">89</span><span class="p">.</span><span class="mi">99999847369712</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-width">
<h3>rst_width<a class="headerlink" href="#rst-width" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_width">
<span class="sig-name descname"><span class="pre">rst_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_width" title="Permalink to this definition"></a></dt>
<dd><p>Computes the width of the raster in pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-28-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-28-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-28-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-28-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-28-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_width</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_width</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                                  <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mi">600</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-28-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_width</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_width</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">600</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-28-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_width</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_width</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">600</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-worldtorastercoord">
<h3>rst_worldtorastercoord<a class="headerlink" href="#rst-worldtorastercoord" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_worldtorastercoord">
<span class="sig-name descname"><span class="pre">rst_worldtorastercoord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xworld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yworld</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_worldtorastercoord" title="Permalink to this definition"></a></dt>
<dd><p>Computes the raster coordinates of the world coordinates.
The raster coordinates are the pixel coordinates of the raster.
The world coordinates are the coordinates in the CRS of the raster.
The coordinates are resolved using GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – X world coordinate.</p></li>
<li><p><strong>y</strong> – Y world coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: StructType(IntegerType, IntegerType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-29-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-29-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-29-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-29-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-29-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>                                                                                     <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">398</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">997</span><span class="p">}</span>                                                                                             <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-29-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">398</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">997</span><span class="p">}</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-29-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter &quot;*.nc&quot;, path &quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;)
SELECT rst_worldtorastercoord(path, -160.1, 40.0)
+------------------------------------------------------------------------------------------------------------------+
| rst_worldtorastercoord(path)                                                                                     |
+------------------------------------------------------------------------------------------------------------------+
| {&quot;x&quot;: 398, &quot;y&quot;: 997}                                                                                             |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-worldtorastercoordx">
<h3>rst_worldtorastercoordx<a class="headerlink" href="#rst-worldtorastercoordx" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_worldtorastercoordx">
<span class="sig-name descname"><span class="pre">rst_worldtorastercoordx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xworld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yworld</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_worldtorastercoordx" title="Permalink to this definition"></a></dt>
<dd><p>Computes the raster coordinates of the world coordinates.
The raster coordinates are the pixel coordinates of the raster.
The world coordinates are the coordinates in the CRS of the raster.
The coordinates are resolved using GeoTransform.
This method returns the X coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – X world coordinate.</p></li>
<li><p><strong>y</strong> – Y world coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-30-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-30-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-30-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-30-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-30-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">-</span><span class="mf">160.1</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>                                                                      <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mi">398</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-30-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-30-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">160.1</span><span class="p">,</span><span class="w"> </span><span class="mf">40.0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">398</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-30-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-30-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">398</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="rst-worldtorastercoordy">
<h3>rst_worldtorastercoordy<a class="headerlink" href="#rst-worldtorastercoordy" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_worldtorastercoordy">
<span class="sig-name descname"><span class="pre">rst_worldtorastercoordy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xworld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yworld</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_worldtorastercoordy" title="Permalink to this definition"></a></dt>
<dd><p>Computes the raster coordinates of the world coordinates.
The raster coordinates are the pixel coordinates of the raster.
The world coordinates are the coordinates in the CRS of the raster.
The coordinates are resolved using GeoTransform.
This method returns the Y coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – X world coordinate.</p></li>
<li><p><strong>y</strong> – Y world coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-31-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-31-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-31-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-31-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-31-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;binaryFile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;pathGlobFilter&quot;</span><span class="p">,</span> <span class="s2">&quot;*.nc&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">-</span><span class="mf">160.1</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>                                                                      <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="mi">997</span>                                                                                                              <span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-31-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;binaryFile&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;pathGlobFilter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*.nc&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">&quot;path&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">160.1</span><span class="p">,</span><span class="w"> </span><span class="mf">40.0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">997</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-31-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">&quot;*.nc&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral&quot;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">997</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="spatial-aggregations.html" class="btn btn-neutral float-left" title="Spatial aggregation functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../usage/usage.html" class="btn btn-neutral float-right" title="Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Databricks Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>